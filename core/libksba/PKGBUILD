# $Id: PKGBUILD 149815 2012-02-11 07:14:25Z tpowa $
# Maintainer: damir <damir@archlinux.org>
# Contributor: Damir Perisa <damir.perisa@bluewin.ch>

pkgname=libksba
pkgver=1.3.2
pkgrel=1
pkgdesc="A CMS and X.509 access library"
arch=('i686' 'x86_64')
license=('GPL')
url="ftp://ftp.gnupg.org/gcrypt/alpha/libksba"
depends=('gettext' 'libgpg-error')
source=(ftp://ftp.gnupg.org/gcrypt/$pkgname/$pkgname-$pkgver.tar.bz2)
md5sums=('c3c9a66e22d87fe3ae59865250b8a09c')
install=libksba.install
options=('libtoolfix')

build() {
  cd $srcdir/$pkgname-$pkgver
  ./configure --prefix=/usr \
              --infodir=/usr/share/info \
              --enable-static
  make
}

check() {
   cd $srcdir/$pkgname-$pkgver
   make check
}

package() {
  cd $srcdir/$pkgname-$pkgver
  make DESTDIR=$pkgdir install

  #temporary libfix
  install -dm755 ${pkgdir}/usr/lib/unfixed
  ln -s /usr/lib/libksba.so.8 "$pkgdir"/usr/lib/unfixed/libksba.so.19
  install -dm755 "$pkgdir"/usr/lib/ldconfig
  echo '/usr/lib/unfixed' > "$pkgdir"/usr/lib/ldconfig/libksba-unfixed

}

# $Id: PKGBUILD 173327 2012-12-19 01:16:33Z allan $
# Maintainer: Allan McRae <allan@archlinux.org>
# Contributor: Eric Belanger <eric@archlinux.org>
# Contributor: Anthony Amzo <amzo@archbsd.net>
_downloadname=nss
pkgname=ca_root_nss
pkgver=3.16
pkgrel=2
pkgdesc="The root certificate bundle from the Mozilla Project"
arch=('any')
license=('MPL')
url="http://www.mozilla.org/"
makedepends=('perl')
source=(https://ftp.mozilla.org/pub/mozilla.org/security/nss/releases/NSS_3_16_RTM/src/${_downloadname}-${pkgver}.tar.gz
	"MAca-bundle.pl")
md5sums=('0a6f8503d08c078d64d500e77678e33c'
         '3a39202d9085d11952bf5dba3189bfe9')

build() {
	 cd ${srcdir}/${_downloadname}-${pkgver}
   
	cp ${srcdir}/${_downloadname}-${pkgver}/${_downloadname}/lib/ckfw/builtins/certdata.txt ${srcdir}
   
	perl ${srcdir}/MAca-bundle.pl \
	< ${srcdir}/certdata.txt > \
	 ${srcdir}/ca-root-nss.crt
}

package() {
	install -dm755 ${pkgdir}/usr/share/certs
	install -m644 ${srcdir}/ca-root-nss.crt ${pkgdir}/usr/share/certs

	install -dm755 ${pkgdir}/etc/ssl
	cd ${pkgdir}/usr/share/certs
	ln -s ca-root-nss.crt ../../../etc/ssl/cert.pem
}
